////////////////////////////////////    Assignment 3 //////////////////////


// Display Recent 50 Orders placed (Id, Order Date, Order Total).

1. SELECT id,shopping_date,total FROM orders
    -> ORDER BY shopping_date DESC
    -> LIMIT 50;



// Display 10 most expensive Orders.

2. SELECT id FROM orders
    -> ORDER BY total DESC
    -> LIMIT 10;



// Display all the Orders which are placed more than 10 days old and one or more items from those orders are still not shipped.

3. SELECT DISTINCT o.id,o.shopping_date,o.total FROM orders o JOIN order_detail od
    -> ON od.order_id = o.id
    -> WHERE od.shipped = FALSE AND o.shopping_date < NOW() - INTERVAL 10 DAY;



//Display list of shoppers which haven't ordered anything since last month.

4. SELECT shopper_id,name,email FROM shopper
    -> WHERE shopper_id NOT IN(SELECT shopper_id FROM orders WHERE shopping_date >= NOW() - INTERVAL 1 MONTH);



// Display list of shopper along with orders placed by them in last 15 days. 

5. SELECT s.shopper_id,s.name,s.email,o.id,o.shopping_date,o.total FROM shopper s JOIN orders o
    -> ON s.shopper_id = o.shopper_id
    -> WHERE o.shopping_date >= NOW() - INTERVAL 15 DAY;



// Display list of order items which are in “shipped” state for particular Order Id (i.e.: 1020))

6. SELECT o.order_id,o.price,o.quantity,p.title,p.description FROM order_detail o JOIN product p
    -> ON p.product_id = o.product_id
    -> WHERE o.shipped = TRUE AND o.id = 1020;




// Display list of order items along with order placed date which fall between Rs 20 to Rs 50 price.

7.  SELECT od.id,o.id AS order_id,p.title,od.quantity,o.shopping_date FROM order_detail od JOIN product p
    -> ON od.product_id = p.product_id JOIN
    -> orders o ON o.id = od.order_id
    -> WHERE od.price BETWEEN 20 AND 50;